import cPickle as pickle
from pybrain.tools.shortcuts import buildNetwork
from pybrain.datasets import SupervisedDataSet
from pybrain.supervised.trainers import BackpropTrainer
import time
import random

net = buildNetwork(2, 3, 1,bias=True)
ds = SupervisedDataSet(2, 1)

for i in range (0,100):
    ds.addSample((0, 0), (0,))
    ds.addSample((0, 1), (1,))
    ds.addSample((1, 0), (1,))
    ds.addSample((1, 1), (0,))

trainer = BackpropTrainer(net,ds)
begin = time.time()
out = trainer.trainUntilConvergence(validationProportion=0.25,continueEpochs=100)
end = time.time()
print 'Time:',end-begin
print 'Error:',min(out[1]) # minimum error
print ''
print net.activate([0,0])
print net.activate([0,1])
print net.activate([1,0])
print net.activate([1,1])
